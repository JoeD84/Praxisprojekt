<!DOCTYPE html><html>
  <head>
    <title>5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf</title>
    <!--Generated by LaTeXML (version 0.7.9alpha) on 2012-06-25T23:30:52+02:00.
        See http://dlmf.nist.gov/LaTeXML/-->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="start" href="Praxisbericht.html" title="">
    <link rel="prev" href="Ch5.S3.html" title="5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf">
    <link rel="next" href="Ch5.S5.html" title="5.5 Kommunikation mit RapidForm2004 ‣ Chapter 5 Zeitlicher Arbeitsablauf">
    <link rel="stylesheet" type="text/css" href="core.css">
    <link rel="stylesheet" type="text/css" href="navbar-left.css">
  </head>
  <body>
    <nav class="navbar"><a href="Praxisbericht.html" title="" class="ref start">?</a>
    
  <ul class="toc">
  <li class="tocentry">
<a href="Praxisbericht.html" title="" class="ref toc">?</a>
  <ul class="toc">
  <li class="tocentry"><a href="Ch1.html" title="Chapter 1 Hinweise zum Dokument" class="ref toc"><span class="text reftitle"><span class="tag">1 </span>Hinweise zum Dokument</span></a></li>
  <li class="tocentry"><a href="Ch2.html" title="Chapter 2 Einleitung" class="ref toc"><span class="text reftitle"><span class="tag">2 </span>Einleitung</span></a></li>
  <li class="tocentry"><a href="Ch3.html" title="Chapter 3 Vorstellung der vorhandenen Hardware" class="ref toc"><span class="text reftitle"><span class="tag">3 </span>Vorstellung der vorhandenen Hardware</span></a></li>
  <li class="tocentry"><a href="Ch4.html" title="Chapter 4 Vorstellung der vorhandenen Software" class="ref toc"><span class="text reftitle"><span class="tag">4 </span>Vorstellung der vorhandenen Software</span></a></li>
  <li class="tocentry">
<a href="Ch5.html" title="Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5 </span>Zeitlicher Arbeitsablauf</span></a>
  <ul class="toc">
  <li class="tocentry"><a href="Ch5.S1.html" title="5.1 Bereitstellen grundlegender Funktionalitäten ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.1 </span>Bereitstellen grundlegender Funktionalitäten</span></a></li>
  <li class="tocentry"><a href="Ch5.S2.html" title="5.2 Befehlssätze ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.2 </span>Befehlssätze</span></a></li>
  <li class="tocentry"><a href="Ch5.S3.html" title="5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.3 </span>Kommunikation mit der vorhandenen Schrittmotorsteuerung</span></a></li>
  <li class="tocentry self">
<span class="ref toc here"><span class="text reftitle"><span class="tag">5.4 </span>Verbesserungen an der vorhandenen Hardware</span></span>
  <ul class="toc">
  <li class="tocentry"><a href="#SS1" title="5.4.1 Netzteil ‣ 5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.4.1 </span>Netzteil</span></a></li>
  <li class="tocentry"><a href="#SS2" title="5.4.2 Zweite Schrittmotorkarte ‣ 5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.4.2 </span>Zweite Schrittmotorkarte</span></a></li>
  <li class="tocentry"><a href="#SS3" title="5.4.3 Motor- und Endschalterverkabelung ‣ 5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.4.3 </span>Motor- und Endschalterverkabelung</span></a></li>
  <li class="tocentry"><a href="#SS4" title="5.4.4 Endschalter ‣ 5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.4.4 </span>Endschalter</span></a></li>
  <li class="tocentry"><a href="#SS5" title="5.4.5 Zweite serielle Schnittstelle ‣ 5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.4.5 </span>Zweite serielle Schnittstelle</span></a></li>
    </ul>
</li>
  <li class="tocentry"><a href="Ch5.S5.html" title="5.5 Kommunikation mit RapidForm2004 ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.5 </span>Kommunikation mit RapidForm2004</span></a></li>
  <li class="tocentry"><a href="Ch5.S6.html" title="5.6 Auswerte-Funktionen ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.6 </span>Auswerte-Funktionen</span></a></li>
  <li class="tocentry"><a href="Ch5.S7.html" title="5.7 Platinenlayout und 19”-Einschub ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.7 </span>Platinenlayout und 19”-Einschub</span></a></li>
    </ul>
</li>
  <li class="tocentry"><a href="Ch6.html" title="Chapter 6 Probleme und Lösungen" class="ref toc"><span class="text reftitle"><span class="tag">6 </span>Probleme und Lösungen</span></a></li>
  <li class="tocentry"><a href="Ch7.html" title="Chapter 7 Fazit und weitere Möglichkeiten" class="ref toc"><span class="text reftitle"><span class="tag">7 </span>Fazit und weitere Möglichkeiten</span></a></li>
  <li class="tocentry"><a href="bib.html" title="Bibliography" class="ref toc"><span class="text reftitle">Bibliography</span></a></li>
  <li class="tocentry"><a href="idx.html" title="Index" class="ref toc"><span class="text reftitle">Index</span></a></li>
    </ul>
</li>
    </ul>
      </nav>
    <div class="main">
    <header class="header"><a href="Ch5.html" title="Chapter 5 Zeitlicher Arbeitsablauf" class="ref up"><span class="text reftitle"><span class="tag">5 </span>Zeitlicher Arbeitsablauf</span></a><a href="Ch5.S3.html" title="5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref previous"><span class="text reftitle"><span class="tag">5.3 </span>Kommunikation mit der vorhandenen Schrittmotorsteuerung</span></a><a href="Ch5.S5.html" title="5.5 Kommunikation mit RapidForm2004 ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref next"><span class="text reftitle"><span class="tag">5.5 </span>Kommunikation mit RapidForm2004</span></a>
      </header>
    <div class="content">
<section class="section"><hgroup><h1 class="title">
<span class="tag">5.4 </span>Verbesserungen an der vorhandenen Hardware</h1></hgroup><section id="SS1" class="subsection"><hgroup><h1 class="title">
<span class="tag">5.4.1 </span>Netzteil</h1></hgroup><div id="SS1.p1" class="para"><p class="p">Ziel dieses Arbeitsschrittes war es, die festen Lötverbindungen zwischen dem PC-Netzteil und den einzelnen Karteneinschüben im 19”-Rack durch Steckverbindungen zu ersetzen und dadurch leicht erweiterbar zu machen.<br class="break">Die festen Lötverbindungen am Einschub für die Schrittmotorkarte wurden durch Standard PC-Netzteil Stecker ersetzt. Die <span class="text" style="background-color:#D9D9FF;">Logikbausteine</span> der Schrittmotorkarte werden mit <em class="emph">5V</em> gespeist. Die Schrittmotorkarte wird zusätzlich mit <em class="emph">12V</em> für den Schrittmotor gespeist. Der Stecker lässt sich nun einfach mit einer Buchse des Standard PC-Netzteils verbinden und es ist nicht mehr Notwendig zu löten wenn das Netzteil ausgebaut wird. Mittels eines Y-Kabels(siehe Abbildung <a href="#Ch5.F1" title="Figure 5.1 ‣ 5.4.1 Netzteil ‣ 5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">5.1</span></a>) können nun leicht weitere Buchsen hinzugefügt werden.<br class="break">Dadurch kann das Netzteil nun einfach ein- und ausgebaut werden, bzw. das System leicht um neue Einschubkarten erweitert werden.</p></div>
<figure id="Ch5.F1" class="figure"><img src="" id="Ch5.F1.g1" class="graphics centering"><figcaption class="caption centering"><span class="tag">Figure 5.1: </span>Stromverbinder - Y-Kabel<cite class="cite">()</cite></figcaption></figure></section><section id="SS2" class="subsection"><hgroup><h1 class="title">
<span class="tag">5.4.2 </span>Zweite Schrittmotorkarte</h1></hgroup><div id="SS2.p1" class="para"><p class="p">Zu Anfang war nur eine Schrittmotorkarte für die Rotation des Drehtisches vorbereitet. Mit einem zweiten Schrittmotor konnte der Tisch in der Höhe verstellt werden. Für diesen fehlte jedoch noch eine zweite Schrittmotorkarte. Diese musste noch vorbereitet und mit der Ersten verbunden werden.<br class="break">Dazu wurde, wie in Kapitel <a href="#SS1" title="5.4.1 Netzteil ‣ 5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">5.4.1</span></a> beschrieben, ein weiterer Einschubplatz für die Schrittmotorkarte vorbereitet. Die Karte wurde mit einer Frontblende versehen und auf dieser eine Buchse für die Motorverkabelung und je eine Buchse und einen Stecker für die seriellen Schnittstellen verbaut. Diese wurden mit den entsprechenden Anschlüssen auf der Schrittmotorkarte verlötet. Die Karte wird in den Einschubplatz geschoben und mit einem seriellen Kabel als <span class="text" style="background-color:#D9D9FF;">Daisy-Chain</span> mit der ersten Schrittmotorkarte verbunden. Dadurch kann die zweite Schrittmotorkarte über die Erste angesteuert werden.<br class="break">Somit steht eine baugleiche Schrittmotorkarte zur Verfügung. Diese kann nun den Schrittmotor für die Höhenverstellung ansteuern. Befehle an diese Schrittmotorkarte werden an die erste Karte geschickt, jedoch mit dem Prefix <em class="emph">2</em>. Dieser weist die erste Karte an, den Befehl an die zweite Karte weiter zu senden. So kann das System um weitere Karten erweitert werden.</p></div></section><section id="SS3" class="subsection"><hgroup><h1 class="title">
<span class="tag">5.4.3 </span>Motor- und Endschalterverkabelung</h1></hgroup><div id="SS3.p1" class="para"><p class="p">Zwischen der zweiten Schrittmotorkarte und dem zugehörigen Schrittmotor, der für die Höhenverstellung zuständig ist, war noch kein Kabel vorhanden. Dieses musste noch gefertigt und um 3 Leitungen für die Endschalter erweitert werden.<br class="break">Dafür wurde in der Werkstatt des RheinAhrCampus Remagen ein 7 adriges Kabel (siehe Abbildung <a href="#Ch5.F2" title="Figure 5.2 ‣ 5.4.3 Motor- und Endschalterverkabelung ‣ 5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">5.2</span></a>) besorgt und die passenden Endstecker bestellt. Die Belegung wurde gleich zum Kabel für den ersten Schrittmotor gewählt, jedoch um die 3 Adern für die beiden Endschalter erweitert. Tabelle <a href="#Ch6.T1" title="Table 6.1 ‣ 5.4.3 Motor- und Endschalterverkabelung ‣ 5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">6.1</span></a> gibt die Belegung des Kabels wieder.<br class="break">Somit stand ein Kabel zur Verfügung mit dem sowohl der Schrittmotor gesteuert, als auch der Status der Endschalter an die Schrittmotorkarte übermittelt werden konnte.</p></div>
<figure id="Ch5.F2" class="figure"><img src="" id="Ch5.F2.g1" class="graphics centering"><figcaption class="caption centering"><span class="tag">Figure 5.2: </span>Motor- und Endschalterverkabelung</figcaption></figure><figure id="Ch6.T1" class="table"><figcaption class="caption"><span class="tag">Table 6.1: </span>Fuses</figcaption><table class="tabular">
<tr class="tr">
    <td class="td l r t" align="center">1</td>
    <td class="td r t" align="left">Phase A</td>
</tr>
<tr class="tr">
    <td class="td l r t" align="center">2</td>
    <td class="td r t" align="left">Phase B</td>
</tr>
<tr class="tr">
    <td class="td l r t" align="center">3</td>
    <td class="td r t" align="left">Phase C</td>
</tr>
<tr class="tr">
    <td class="td l r t" align="center">4</td>
    <td class="td r t" align="left">Phase D</td>
</tr>
<tr class="tr">
    <td class="td l r t" align="center">5</td>
    <td class="td r t" align="left">Endschalter oben</td>
</tr>
<tr class="tr">
    <td class="td l r t" align="center">6</td>
    <td class="td r t" align="left">Endschalter unten</td>
</tr>
<tr class="tr">
    <td class="td b l r t" align="center">7</td>
    <td class="td b r t" align="left">Endschalter Masse</td>
</tr>
</table></figure></section><section id="SS4" class="subsection"><hgroup><h1 class="title">
<span class="tag">5.4.4 </span>Endschalter</h1></hgroup><div id="SS4.p1" class="para"><p class="p">Nun sollen die vorgegeben induktiven Endschalter mit der Schrittmotorkarte und dem Mikrocontroller zu verbinden. Dadurch soll gewährleistet werden, dass der Drehtisch nicht über den Arbeitsbereich hinaus bewegt werden kann. Zusätzlich soll das Erreichen der Endpositionen auf dem LC-Display angezeigt werden.<br class="break">Da die Schrittmotorkarte nur mechanische Endschalter unterstützt, ließen sich die induktiven Endschalter nicht ohne weiteres nutzen. Um die induktiven Endschalter nutzen zu können, musste die Spannung über einen Spannungsteiler heruntergesetzt werden und die standardmäßigen Eingänge für die mechanischen Endschalter umgangen werden. Die induktiven Endschalter werden direkt an den Optokoppler angeschlossen, welcher für die mechanischen Endschalter zuständig ist. Dadurch wurden die Signale der Endschalter für die Schrittmotorkarte nutzbar.</p></div>
<figure id="Ch5.F3" class="figure"><img src="" id="Ch5.F3.g1" class="graphics centering"><figcaption class="caption centering"><span class="tag">Figure 5.3: </span>Endschalterverkabelung</figcaption></figure><div id="SS4.p2" class="para"><p class="p">Ein weiteres Problem bestand darin, dass, wenn der Tisch sich bereits in der Endposition befand, die Endschalter noch nicht aktiviert wurden. Dies lag daran, dass der Metallstutzen, der die Endschalter auslösen sollte, sich nicht im Schaltbereich der induktiven Schalter befand. Zur Abhilfe wurde ein längerer Metallstutzen von der Werkstatt des RheinAhrCampus angefertigt.<br class="break">Wenn der Tisch sich in der Endposition befindet, soll dies auch auf dem LC-Display angezeigt werden. Die Signale der Endschalter liegen auf der Rückseite der Schrittmotorkarte am Verbindungsstecker an. Um die Signale dem Mikrocontroller zugänglich zu machen wurde eine Brücke zwischen den Verbindungssteckern der Schrittmotorkarte und der Mikrocontroller-Platine gelötet. Auf der Mikrocontroller-Platine sind diese beiden Pins mit je einem Pin des Mikrocontrollers verbunden. Diese beiden Pins werden im Mikrocontroller als <span class="text" style="background-color:#D9D9FF;">Interrupts</span> definiert. Die <span class="text" style="background-color:#D9D9FF;">Interrupt-Service-Routine</span> zum Anzeigen der Nachricht auf dem LC-Display wird in Kapitel <a href="Ch6.S2.html#SS1" title="6.2.1 Endschalter ‣ 6.2 Interrupts ‣ Chapter 6 Probleme und Lösungen" class="ref"><span class="text reftag">6.2.1</span></a> beschrieben.<br class="break">Da die Signale der Endschalter nun an der Schrittmotorkarte anliegen, stoppt diese den Motor wenn eine der Endschalterpositionen erreicht wird. Zusätzlich liegen die Signale am Mikrocontroller an. Dieser gibt dadurch auf dem Display die Meldung <em class="emph">Endschalterposition erreicht!</em> aus.</p></div></section><section id="SS5" class="subsection"><hgroup><h1 class="title">
<span class="tag">5.4.5 </span>Zweite serielle Schnittstelle</h1></hgroup><div id="SS5.p1" class="para"><p class="p">Das STK500 bietet nur eine serielle Schnittstelle. Um zusätzlich zur Schrittmotorkarte auch mit RapidForm2004 kommunizieren zu können, wird eine zweite RS-232-Schnittstelle benötigt.<br class="break">Dafür wurde vorerst auf einem Steckbrett eine zweite serielle Schnittstelle nach dem Schaltplan in Abbildung <a href="#Ch5.F4" title="Figure 5.4 ‣ 5.4.5 Zweite serielle Schnittstelle ‣ 5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">5.4</span></a> aufgebaut. Später wird diese Schnittstelle direkt auf der Mikrocontroller-Platine realisiert.
Dadurch ist es möglich mit dem Mikrocontroller über zwei RS-232-Schnittstellen gleichzeitig zu kommunizieren.</p></div>
<figure id="Ch5.F4" class="figure"><img src="" id="Ch5.F4.g1" class="graphics centering"><figcaption class="caption centering"><span class="tag">Figure 5.4: </span>Schaltplan für die zweite serielle Schnittstelle
<cite class="cite">()</cite></figcaption></figure></section></section>
        </div>
    <footer class="footer">June 25, 2012<a href="Ch5.S3.html" title="5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref previous"><span class="text reftitle"><span class="tag">5.3 </span>Kommunikation mit der vorhandenen Schrittmotorsteuerung</span></a><a href="Ch5.S5.html" title="5.5 Kommunikation mit RapidForm2004 ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref next"><span class="text reftitle"><span class="tag">5.5 </span>Kommunikation mit RapidForm2004</span></a>
      </footer>
      </div>
    </body>
</html>
