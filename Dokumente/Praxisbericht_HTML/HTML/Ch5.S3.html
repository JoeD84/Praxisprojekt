<!DOCTYPE html><html>
  <head>
    <title>5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf</title>
    <!--Generated by LaTeXML (version 0.7.9alpha) on 2012-06-25T23:30:52+02:00.
        See http://dlmf.nist.gov/LaTeXML/-->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="start" href="Praxisbericht.html" title="">
    <link rel="prev" href="Ch5.S2.html" title="5.2 Befehlssätze ‣ Chapter 5 Zeitlicher Arbeitsablauf">
    <link rel="next" href="Ch5.S4.html" title="5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf">
    <link rel="stylesheet" type="text/css" href="core.css">
    <link rel="stylesheet" type="text/css" href="navbar-left.css">
  </head>
  <body>
    <nav class="navbar"><a href="Praxisbericht.html" title="" class="ref start">?</a>
    
  <ul class="toc">
  <li class="tocentry">
<a href="Praxisbericht.html" title="" class="ref toc">?</a>
  <ul class="toc">
  <li class="tocentry"><a href="Ch1.html" title="Chapter 1 Hinweise zum Dokument" class="ref toc"><span class="text reftitle"><span class="tag">1 </span>Hinweise zum Dokument</span></a></li>
  <li class="tocentry"><a href="Ch2.html" title="Chapter 2 Einleitung" class="ref toc"><span class="text reftitle"><span class="tag">2 </span>Einleitung</span></a></li>
  <li class="tocentry"><a href="Ch3.html" title="Chapter 3 Vorstellung der vorhandenen Hardware" class="ref toc"><span class="text reftitle"><span class="tag">3 </span>Vorstellung der vorhandenen Hardware</span></a></li>
  <li class="tocentry"><a href="Ch4.html" title="Chapter 4 Vorstellung der vorhandenen Software" class="ref toc"><span class="text reftitle"><span class="tag">4 </span>Vorstellung der vorhandenen Software</span></a></li>
  <li class="tocentry">
<a href="Ch5.html" title="Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5 </span>Zeitlicher Arbeitsablauf</span></a>
  <ul class="toc">
  <li class="tocentry"><a href="Ch5.S1.html" title="5.1 Bereitstellen grundlegender Funktionalitäten ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.1 </span>Bereitstellen grundlegender Funktionalitäten</span></a></li>
  <li class="tocentry"><a href="Ch5.S2.html" title="5.2 Befehlssätze ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.2 </span>Befehlssätze</span></a></li>
  <li class="tocentry self">
<span class="ref toc here"><span class="text reftitle"><span class="tag">5.3 </span>Kommunikation mit der vorhandenen Schrittmotorsteuerung</span></span>
  <ul class="toc">
  <li class="tocentry"><a href="#SS1" title="5.3.1 Befehle senden ‣ 5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.3.1 </span>Befehle senden</span></a></li>
  <li class="tocentry"><a href="#SS2" title="5.3.2 Antworten empfangen und speichern ‣ 5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.3.2 </span>Antworten empfangen und speichern</span></a></li>
  <li class="tocentry"><a href="#SS3" title="5.3.3 Antworten auswerten ‣ 5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.3.3 </span>Antworten auswerten</span></a></li>
    </ul>
</li>
  <li class="tocentry"><a href="Ch5.S4.html" title="5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.4 </span>Verbesserungen an der vorhandenen Hardware</span></a></li>
  <li class="tocentry"><a href="Ch5.S5.html" title="5.5 Kommunikation mit RapidForm2004 ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.5 </span>Kommunikation mit RapidForm2004</span></a></li>
  <li class="tocentry"><a href="Ch5.S6.html" title="5.6 Auswerte-Funktionen ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.6 </span>Auswerte-Funktionen</span></a></li>
  <li class="tocentry"><a href="Ch5.S7.html" title="5.7 Platinenlayout und 19”-Einschub ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.7 </span>Platinenlayout und 19”-Einschub</span></a></li>
    </ul>
</li>
  <li class="tocentry"><a href="Ch6.html" title="Chapter 6 Probleme und Lösungen" class="ref toc"><span class="text reftitle"><span class="tag">6 </span>Probleme und Lösungen</span></a></li>
  <li class="tocentry"><a href="Ch7.html" title="Chapter 7 Fazit und weitere Möglichkeiten" class="ref toc"><span class="text reftitle"><span class="tag">7 </span>Fazit und weitere Möglichkeiten</span></a></li>
  <li class="tocentry"><a href="bib.html" title="Bibliography" class="ref toc"><span class="text reftitle">Bibliography</span></a></li>
  <li class="tocentry"><a href="idx.html" title="Index" class="ref toc"><span class="text reftitle">Index</span></a></li>
    </ul>
</li>
    </ul>
      </nav>
    <div class="main">
    <header class="header"><a href="Ch5.html" title="Chapter 5 Zeitlicher Arbeitsablauf" class="ref up"><span class="text reftitle"><span class="tag">5 </span>Zeitlicher Arbeitsablauf</span></a><a href="Ch5.S2.html" title="5.2 Befehlssätze ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref previous"><span class="text reftitle"><span class="tag">5.2 </span>Befehlssätze</span></a><a href="Ch5.S4.html" title="5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref next"><span class="text reftitle"><span class="tag">5.4 </span>Verbesserungen an der vorhandenen Hardware</span></a>
      </header>
    <div class="content">
<section class="section"><hgroup><h1 class="title">
<span class="tag">5.3 </span>Kommunikation mit der vorhandenen Schrittmotorsteuerung</h1></hgroup><section id="SS1" class="subsection"><hgroup><h1 class="title">
<span class="tag">5.3.1 </span>Befehle senden</h1></hgroup><div id="SS1.p1" class="para"><p class="p">Im nächsten Schritt geht es darum, Befehle an die Schrittmotorkarte zu versenden. Da es nicht möglich ist, für jeden Befehl eine eigene Taste zu verwenden,
wird eine menübasierte Steuerung mittels des LC-Displays verwendet. Im Menü lässt sich mit den Tasten <em class="emph">Hoch</em>, <em class="emph">Runter</em>, <em class="emph">Ok</em>, und <em class="emph">Zurück</em>, navigieren.<br class="break">Analog wie beim LC-Display und bei den Tastern wird hier eine vorhandene Bibliothek genutzt. Um die Bibliothek verwenden zu können musste die Menüstruktur den Bedürfnissen des Projekts angepasst werden und die Funktionen zum Ausgeben von Text auf dem LC-Display und zum Versenden von Befehlen über die RS-232-Schnittstelle, aus den vorangegangen Kapiteln, bekannt gemacht werden. Dies geschieht in der Datei <span class="text typewriter" style="background-color:#FFFFE6;">tinymenu/tinymenu.h</span>.<br class="break">Die Zeilen 1–6 des Codelisting <a href="#LST6" title="6 ‣ 5.3.1 Befehle senden ‣ 5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">6</span></a> dienen zum Einbinden der benötigten Bibliotheken. Die Zeilen 8–20 zeigen eine vereinfachte Struktur des Hauptprogramms. Wird ein Taster gedrückt, wird dies durch die <span class="text typewriter" style="color:#0000FF;background-color:#FFFFE6;">get_key_press()</span>-Funktion, bekannt aus Kapitel <a href="Ch5.S1.html#SS1" title="5.1.1 Taster ‣ 5.1 Bereitstellen grundlegender Funktionalitäten ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">5.1.1</span></a>, erkannt und die entsprechende Menü Funktion aufgerufen.</p></div>
<figure id="LST6" class="listing language_C"><figcaption class="caption"><span class="tag">Listing 6: </span>Menü</figcaption><table class="tabular">
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">1</span></td>
    <td class="td"><span class="text lstline footnote">define<span class="text lstspace"> </span>MCU_CLK<span class="text lstspace"> </span>F_CPU</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">2</span></td>
    <td class="td"><span class="text lstline footnote">keywordstyle <span class="text lstdirectives">include</span><span class="text lstspace"> </span>”<span class="text" style="color:#000000;">tinymenu/spin_delay.h</span>”</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">3</span></td>
    <td class="td"><span class="text lstline footnote">define<span class="text lstspace"> </span>CONFIG_TINYMENU_USE_CLEAR</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">4</span></td>
    <td class="td"><span class="text lstline footnote">keywordstyle <span class="text lstdirectives">include</span><span class="text lstspace"> </span>”<span class="text" style="color:#000000;">tinymenu/tinymenu.h</span>”</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">5</span></td>
    <td class="td"><span class="text lstline footnote">include<span class="text lstspace"> </span>”tinymenu/tinymenu_hw.h”</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">6</span></td>
    <td class="td"><span class="text lstline footnote">keywordstyle <span class="text lstdirectives">include</span><span class="text lstspace"> </span>”<span class="text" style="color:#000000;">mymenu.h</span>”</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">7</span></td>
    <td class="td"><span class="text lstline footnote">//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Gekuerzte<span class="text lstspace"> </span>Main-Funktion</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">8</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstkeywords" style="color:#FF0000;">int</span><span class="text lstspace"> </span>main(<span class="text lstkeywords" style="color:#FF0000;">void</span>)<span class="text lstspace"> </span>{</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">9</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span><span class="text lstkeywords" style="color:#FF0000;">while</span><span class="text lstspace"> </span>(1)<span class="text lstspace"> </span>{<span class="text lstspace">  </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">In<span class="text lstspace"> </span>Endlosschleife<span class="text lstspace"> </span>wechseln</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">10</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span>wdt_reset();<span class="text lstspace">     </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Watchdog<span class="text lstspace"> </span>zuruecksetzen</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">11</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span><span class="text lstkeywords" style="color:#FF0000;">if</span><span class="text lstspace"> </span>(get_key_press(1<span class="text lstspace"> </span>&lt;&lt;<span class="text lstspace"> </span>KEY1))<span class="text lstspace">      </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">1<span class="text lstspace"> </span>-<span class="text lstspace"> </span>Zurueck</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">12</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                        </span>menu_exit(&amp;menu_context);</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">13</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span><span class="text lstkeywords" style="color:#FF0000;">if</span>(<span class="text lstspace"> </span>get_key_press(1<span class="text lstspace"> </span>&lt;&lt;<span class="text lstspace"> </span>KEY2))<span class="text lstspace">      </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">2<span class="text lstspace"> </span>-<span class="text lstspace"> </span>Hoch</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">14</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                        </span>menu_prev_entry(&amp;menu_context);</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">15</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span><span class="text lstkeywords" style="color:#FF0000;">if</span><span class="text lstspace"> </span>(get_key_press(1<span class="text lstspace"> </span>&lt;&lt;<span class="text lstspace"> </span>KEY3))<span class="text lstspace">      </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">3<span class="text lstspace"> </span>-<span class="text lstspace"> </span>Runter</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">16</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                        </span>menu_next_entry(&amp;menu_context);</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">17</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span><span class="text lstkeywords" style="color:#FF0000;">if</span><span class="text lstspace"> </span>(get_key_press(1<span class="text lstspace"> </span>&lt;&lt;<span class="text lstspace"> </span>KEY4))<span class="text lstspace">      </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">4<span class="text lstspace"> </span>-<span class="text lstspace"> </span>Ok</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">18</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                        </span>menu_select(&amp;menu_context);</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">19</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>}</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">20</span></td>
    <td class="td"><span class="text lstline footnote">}</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">21</span></td>
    <td class="td"><span class="text lstline footnote">//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Funktion<span class="text lstspace"> </span>zum<span class="text lstspace"> </span>senden<span class="text lstspace"> </span>der<span class="text lstspace"> </span>Menuepunkte<span class="text lstspace"> </span>ueber<span class="text lstspace"> </span>die<span class="text lstspace"> </span>serielle<span class="text lstspace"> </span>Schnittstelle</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">22</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstkeywords" style="color:#FF0000;">void</span><span class="text lstspace">        </span>menu_puts<span class="text lstspace">                </span>(<span class="text lstkeywords" style="color:#FF0000;">void</span><span class="text lstspace"> </span>*arg,<span class="text lstspace"> </span><span class="text lstkeywords" style="color:#FF0000;">char</span><span class="text lstspace"> </span>*name)<span class="text lstspace"> </span>{<span class="text lstspace"> </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Menu/Sende<span class="text lstspace"> </span>Funktion</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">23</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>uart_put_string(arg,<span class="text lstspace"> </span>D_Stepper);<span class="text lstspace">   </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Uebergebenen<span class="text lstspace"> </span>String<span class="text lstspace"> </span>an<span class="text lstspace"> </span>Stepper<span class="text lstspace"> </span>senden</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">24</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Befehl<span class="text lstspace"> </span>auf<span class="text lstspace"> </span>Display<span class="text lstspace"> </span>ausgeben</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">25</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>lcd_clrscr();</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">26</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>lcd_puts(”<span class="text" style="color:#000000;">Sent:<span class="text lstspace"> </span></span>”);</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">27</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>lcd_puts(arg);</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">28</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>lcd_puts(”<span class="text" style="color:#000000;">\n</span>”);</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">29</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>ms_spin(100);</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">30</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>//<span class="text" style="color:#008000;">if<span class="text lstspace"> </span>((UCSR1A<span class="text lstspace"> </span>&amp;<span class="text lstspace"> </span>(1<span class="text lstspace"> </span>&lt;&lt;<span class="text lstspace"> </span>RXC1)))</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">31</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>uart_rx(D_Stepper);<span class="text lstspace">     </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Antwort<span class="text lstspace"> </span>des<span class="text lstspace"> </span>Stepper<span class="text lstspace"> </span>empfangen</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">32</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>ms_spin(1000);<span class="text lstspace">         </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Antwort<span class="text lstspace"> </span>noch<span class="text lstspace"> </span>eine<span class="text lstspace"> </span>weile<span class="text lstspace"> </span>Anzeigen</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">33</span></td>
    <td class="td"><span class="text lstline footnote">}</span></td>
</tr>
</table></figure><div id="SS1.p2" class="para"><p class="p">Folgende Menüpunkte wurden realisiert:</p></div>
<figure id="LST7" class="listing language_C"><figcaption class="caption"><span class="tag">Listing 7: </span>Menü Baum</figcaption><table class="tabular">
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">1</span></td>
    <td class="td"><span class="text lstline footnote">Main<span class="text lstspace"> </span>Menu</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">2</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">  </span>Bewegen<span class="text lstspace"> </span>-<span class="text lstspace"> </span>Rotation</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">3</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">    </span>+90</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">4</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">    </span>-90</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">5</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">    </span>+10.000<span class="text lstspace"> </span>Schritte</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">6</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">    </span>-10.000<span class="text lstspace"> </span>Schritte</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">7</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">    </span>Gehe<span class="text lstspace"> </span>zum<span class="text lstspace"> </span>Uhrsprung</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">8</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">  </span>Bewegen<span class="text lstspace"> </span>-<span class="text lstspace"> </span>Hoehe</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">9</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">    </span>+500000</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">10</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">    </span>-500000</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">11</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">    </span>+1000000</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">12</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">    </span>-1000000</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">13</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">    </span>Gehe<span class="text lstspace"> </span>zum<span class="text lstspace"> </span>Ursprung</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">14</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">  </span>Konfigurieren</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">15</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">    </span>Motorstatus</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">16</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">    </span>Setze<span class="text lstspace"> </span>Ursprung</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">17</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">    </span>Write<span class="text lstspace"> </span>to<span class="text lstspace"> </span>EEPROM</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">18</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">    </span>Newline<span class="text lstspace"> </span>1</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">19</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">    </span>Parameter<span class="text lstspace"> </span>Auslesen</span></td>
</tr>
</table></figure><div id="SS1.p3" class="para"><p class="p">Wird einer der Menüpunkte aufgerufen, wird die im Menüpunkt hinterlegte Funktion mit dem hinterlegten Parameter aufgerufen. Wird beispielsweise der Befehl <em class="emph">+90</em> ausgewählt, wird die hinterlegte Funktion <span class="text typewriter" style="color:#0000FF;background-color:#FFFFE6;">menu_puts(arg, name)</span>(Codelisting <a href="#LST6" title="6 ‣ 5.3.1 Befehle senden ‣ 5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">6</span></a> Zeile 18-28) mit dem hinterlegten Wert aufgerufen. Diese sendet dann mit der aus Kapitel <a href="Ch5.S1.html#SS4" title="5.1.4 RS-232-Schnittstelle ‣ 5.1 Bereitstellen grundlegender Funktionalitäten ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">5.1.4</span></a> bekannten Funktion <span class="text typewriter" style="color:#0000FF;background-color:#FFFFE6;">uart_puts(arg, dir)</span> einen Befehl an die Schrittmotorsteuerung.<br class="break">Es ist somit nun möglich mit Tastern vordefinierte Befehle aus dem Menü auszuwählen und an die Schrittmotorsteuerung zu senden.</p></div></section><section id="SS2" class="subsection"><hgroup><h1 class="title">
<span class="tag">5.3.2 </span>Antworten empfangen und speichern</h1></hgroup><div id="SS2.p1" class="para"><p class="p">Die Schrittmotorsteuerung antwortet auf Befehle mit einem <span class="text" style="background-color:#D9D9FF;">String</span>. In diesem Arbeitsschritt wird die Funktionalität zum Empfangen von Antworten der Schrittmotorsteuerung auf Befehle des Mikrocontrollers hergestellt. Diese Antworten sollen in einem String gespeichert und im nächsten Schritt an eine <em class="emph">Auswerte-Funktion</em> weiter gegeben werden.<br class="break">Dazu wird in der Hauptschleife des Programms ständig das Eingangsregister der ersten seriellen Schnittstelle abgefragt (siehe Codelisting <a href="#LST8" title="8 ‣ 5.3.2 Antworten empfangen und speichern ‣ 5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">8</span></a> Zeile 10–13). Dieses Vorgehen bezeichnet man als <span class="text" style="background-color:#D9D9FF;">Polling</span>.
Sind Daten im Register vorhanden, wird <span class="text typewriter" style="color:#0000FF;background-color:#FFFFE6;">LED3</span> eingeschaltet und die Funktion <span class="text typewriter" style="color:#0000FF;background-color:#FFFFE6;">uart_rx(int dir)</span> mit dem Parameter <span class="text typewriter" style="color:#0000FF;background-color:#FFFFE6;">D_Stepper</span> aufgerufen. Der übergebene Parameter gibt an, dass der Befehl von der für die Schrittmotorkarte zuständigen Schnittstelle empfangen wurde. Dadurch wird sichergestellt, dass der empfangene <span class="text" style="background-color:#D9D9FF;">String</span> aus dem richtigen Datenempfangsregister ausgelesen wird und festgelegt wie er weiterverarbeitet wird. Die Funktion <span class="text typewriter" style="color:#0000FF;background-color:#FFFFE6;">uart_rx(dir)</span> liest dann das Empfangsregister mit der aus Kapitel <a href="Ch5.S1.html#SS4" title="5.1.4 RS-232-Schnittstelle ‣ 5.1 Bereitstellen grundlegender Funktionalitäten ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">5.1.4</span></a> bekannten Funktion <span class="text typewriter" style="color:#0000FF;background-color:#FFFFE6;">uart_get_string(str_rx, dir)</span> aus und schreibt den empfangenen String in die Variable <span class="text typewriter" style="color:#0000FF;background-color:#FFFFE6;">str_rx</span>(Codelisting <a href="#LST8" title="8 ‣ 5.3.2 Antworten empfangen und speichern ‣ 5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">8</span></a>, Zeile 7). In einer <span class="text" style="background-color:#D9D9FF;">if-Abfrage</span> wird entschieden von welcher Schnittstelle der empfangene Befehl kam. Da <span class="text typewriter" style="color:#0000FF;background-color:#FFFFE6;">D_Stepper</span> übergeben wurde, wird der if-Teil der Abfrage ausgeführt. In dieser wird der empfangene String an die <em class="emph">Auswerte-Funktion</em> für die Schrittmotorkarte (Codelisting <a href="#LST8" title="8 ‣ 5.3.2 Antworten empfangen und speichern ‣ 5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">8</span></a>, Zeile 15-45) übergeben.
Durch diesen Teil des Programms ist es nun möglich Antworten der Schrittmotorkarte zu empfangen, in dem String <span class="text typewriter" style="color:#0000FF;background-color:#FFFFE6;">str_rx</span> zu speichern und an die Auswerte-Funktion <span class="text typewriter" style="color:#0000FF;background-color:#FFFFE6;">switch_Stepper(str_rx)</span> zu übergeben.</p></div>
<figure id="LST8" class="listing language_C"><figcaption class="caption"><span class="tag">Listing 8: </span>RS-232 Empfang</figcaption><table class="tabular">
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">1</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstkeywords" style="color:#FF0000;">if</span><span class="text lstspace"> </span>((UCSR1A<span class="text lstspace"> </span>&amp;<span class="text lstspace"> </span>(1<span class="text lstspace"> </span>&lt;&lt;<span class="text lstspace"> </span>RXC1))){<span class="text lstspace">                </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Stepper<span class="text lstspace"> </span>Polling</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">2</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>LED_PORT<span class="text lstspace"> </span>&amp;=<span class="text lstspace"> </span>(<span class="text lstspace"> </span>1<span class="text lstspace"> </span>&lt;&lt;<span class="text lstspace"> </span>LED3<span class="text lstspace"> </span>);<span class="text lstspace">          </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">LED<span class="text lstspace"> </span>einschalten</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">3</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>uart_rx(D_Stepper);<span class="text lstspace">                     </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Register<span class="text lstspace"> </span>auslesen</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">4</span></td>
    <td class="td"><span class="text lstline footnote">}</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">5</span></td>
    <td class="td"><span class="text lstline footnote">//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">UART<span class="text lstspace"> </span>Empfangsregister<span class="text lstspace"> </span>auslesen</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">6</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstkeywords" style="color:#FF0000;">void</span><span class="text lstspace">        </span>uart_rx<span class="text lstspace">                                </span>(<span class="text lstkeywords" style="color:#FF0000;">int</span><span class="text lstspace"> </span>dir)<span class="text lstspace"> </span>{</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">7</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>uart_get_string(str_rx,<span class="text lstspace"> </span>dir);<span class="text lstspace">   </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">String<span class="text lstspace"> </span>aus<span class="text lstspace"> </span>Empfangsregister<span class="text lstspace"> </span>auslesen</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">8</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span><span class="text lstkeywords" style="color:#FF0000;">if</span><span class="text lstspace"> </span>(dir<span class="text lstspace"> </span>==<span class="text lstspace"> </span>D_Stepper)<span class="text lstspace">         </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Empfangsregister<span class="text lstspace"> </span>Stepper</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">9</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span>switch_Stepper(str_rx);<span class="text lstspace">     </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Uebersetzungsfunktion<span class="text lstspace"> </span>fuer<span class="text lstspace"> </span>Stepper<span class="text lstspace"> </span>aufrufen</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">10</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span><span class="text lstkeywords" style="color:#FF0000;">else</span>{<span class="text lstspace">                               </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Empfangsregister<span class="text lstspace"> </span>RapidForm</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">11</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Wird<span class="text lstspace"> </span>spaeter<span class="text lstspace"> </span>erklaert</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">12</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>}</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">13</span></td>
    <td class="td"><span class="text lstline footnote">}</span></td>
</tr>
</table></figure></section><section id="SS3" class="subsection"><hgroup><h1 class="title">
<span class="tag">5.3.3 </span>Antworten auswerten</h1></hgroup><div id="SS3.p1" class="para"><p class="p">Die Funktion zum Auswerten empfangener Strings spielt eine zentrale Rolle im Projekt. Diese Funktion ermöglicht es, ankommende Strings im Mikrocontroller gegen die bekannten Antworten zu prüfen und eine entsprechende Reaktion auszuführen.<br class="break">In der Auswerte-Funktion wird der übergebene String mittels der Funktion<br class="break"><span class="text typewriter" style="color:#0000FF;background-color:#FFFFE6;">FindStringInArray(str_rx, pOptions, length)</span>(Codelisting <a href="#LST9" title="9 ‣ 5.3.3 Antworten auswerten ‣ 5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">9</span></a>) gegen ein <span class="text" style="background-color:#D9D9FF;">Array</span> (Codelisting <a href="#LST10" title="10 ‣ 5.3.3 Antworten auswerten ‣ 5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">10</span></a>, Zeile 3) mit bekannten Befehlen geprüft. Ist der String in diesem Array vorhanden, wird die Position des Strings im Array zurückgegeben, ansonsten wird ”99” zurückgegeben. In einer anschließenden <span class="text" style="background-color:#D9D9FF;">switch/case-Struktur</span> wird dann der Position im Array ein bestimmtes Verhalten des Mikrocontrollers zugeordnet. Wird beispielsweise der String <span class="text typewriter" style="color:#0000FF;background-color:#FFFFE6;">#</span> empfangen, wird Position <span class="text typewriter" style="color:#0000FF;background-color:#FFFFE6;">0</span> zurück gegeben und auf dem LC-Display wird <em class="emph">Erfolgreich</em> ausgegeben.<br class="break">Durch diese Funktion kann nun auf Strings reagiert werden und eine entsprechende Reaktion seitens des Mikrocontrollers erfolgen.
</p></div>
<figure id="LST9" class="listing language_Java"><figcaption class="caption"><span class="tag">Listing 9: </span>FindStringInArray()</figcaption><table class="tabular">
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">1</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstkeywords" style="color:#FF0000;">int</span><span class="text lstspace">        </span>FindStringInArray<span class="text lstspace">        </span>(<span class="text lstkeywords" style="color:#FF0000;">const</span><span class="text lstspace"> </span><span class="text lstkeywords" style="color:#FF0000;">char</span>*<span class="text lstspace"> </span>pInput,<span class="text lstspace"> </span><span class="text lstkeywords" style="color:#FF0000;">const</span><span class="text lstspace"> </span><span class="text lstkeywords" style="color:#FF0000;">char</span>*<span class="text lstspace"> </span>pOptions[],<span class="text lstspace"> </span><span class="text lstkeywords" style="color:#FF0000;">int</span><span class="text lstspace"> </span>cmp_length)<span class="text lstspace"> </span>{</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">2</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span><span class="text lstkeywords" style="color:#FF0000;">int</span><span class="text lstspace"> </span>n<span class="text lstspace"> </span>=<span class="text lstspace"> </span>-1;</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">3</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span><span class="text lstkeywords" style="color:#FF0000;">while</span><span class="text lstspace"> </span>(pOptions[++n])<span class="text lstspace"> </span>{<span class="text lstspace">       </span>//<span class="text" style="color:#008000;">Array<span class="text lstspace"> </span>durchlaufen<span class="text lstspace"> </span>bis<span class="text lstspace"> </span>0<span class="text lstspace"> </span>terminiert</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">4</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span>//<span class="text" style="color:#008000;">Wenn<span class="text lstspace"> </span>pInput<span class="text lstspace"> </span>==<span class="text lstspace"> </span>pOptions<span class="text lstspace"> </span>dann<span class="text lstspace"> </span>gib<span class="text lstspace"> </span>Array<span class="text lstspace"> </span>Position<span class="text lstspace"> </span>zurueck</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">5</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span><span class="text lstkeywords" style="color:#FF0000;">if</span><span class="text lstspace"> </span>(!strncmp(pInput,<span class="text lstspace"> </span>pOptions[n],<span class="text lstspace"> </span>cmp_length))<span class="text lstspace">    </span><span class="text lstkeywords" style="color:#FF0000;">return</span><span class="text lstspace"> </span>n;</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">6</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>}</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">7</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span><span class="text lstkeywords" style="color:#FF0000;">return</span><span class="text lstspace"> </span>99;<span class="text lstspace"> </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Wenn<span class="text lstspace"> </span>keine<span class="text lstspace"> </span>uebereinstimmung,<span class="text lstspace"> </span>gib<span class="text lstspace"> </span>99<span class="text lstspace"> </span>zurueck</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">8</span></td>
    <td class="td"><span class="text lstline footnote">}</span></td>
</tr>
</table></figure><figure id="LST10" class="listing language_Java"><figcaption class="caption"><span class="tag">Listing 10: </span>switchStepper()</figcaption><table class="tabular">
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">1</span></td>
    <td class="td"><span class="text lstline footnote">//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Uebersetzung<span class="text lstspace"> </span>Schrittmotorkarte</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">2</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstkeywords" style="color:#FF0000;">void</span><span class="text lstspace">        </span>switch_Stepper<span class="text lstspace">                </span>(<span class="text lstkeywords" style="color:#FF0000;">char</span><span class="text lstspace"> </span>*<span class="text lstspace"> </span>str_rx)<span class="text lstspace"> </span>{</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">3</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span><span class="text lstkeywords" style="color:#FF0000;">const</span><span class="text lstspace"> </span><span class="text lstkeywords" style="color:#FF0000;">char</span>*<span class="text lstspace"> </span>pOptions[]<span class="text lstspace"> </span>=<span class="text lstspace"> </span>{<span class="text lstspace">       </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">Array<span class="text lstspace"> </span>mit<span class="text lstspace"> </span>bekannten<span class="text lstspace"> </span>Befehlen</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">4</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                        </span>”<span class="text" style="color:#000000;">#</span>”,<span class="text lstspace">    </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">0<span class="text lstspace"> </span>-<span class="text lstspace"> </span>Stepper<span class="text lstspace"> </span>Karte<span class="text lstspace"> </span>hat<span class="text lstspace"> </span>Befehl<span class="text lstspace"> </span>erkannt</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">5</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                        </span>”<span class="text" style="color:#000000;">E</span>”,<span class="text lstspace">    </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">1<span class="text lstspace"> </span>-<span class="text lstspace"> </span>Stepper<span class="text lstspace"> </span>Karte<span class="text lstspace"> </span>meldet<span class="text lstspace"> </span>Error</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">6</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                        </span>”<span class="text" style="color:#000000;">!CLS</span>”,<span class="text lstspace"> </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">2<span class="text lstspace"> </span>-<span class="text lstspace"> </span>Clear<span class="text lstspace"> </span>Screen<span class="text lstspace"> </span>(Debugging)</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">7</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                        </span>”<span class="text" style="color:#000000;">Test</span>”,<span class="text lstspace"> </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">3<span class="text lstspace"> </span>-<span class="text lstspace"> </span>Test<span class="text lstspace"> </span>(Debugging)</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">8</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                        </span>0<span class="text lstspace"> </span>};</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">9</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span><span class="text lstkeywords" style="color:#FF0000;">switch</span><span class="text lstspace"> </span>(FindStringInArray(str_rx,<span class="text lstspace"> </span>pOptions,<span class="text lstspace"> </span>1))<span class="text lstspace"> </span>{<span class="text lstspace"> </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">String<span class="text lstspace"> </span>gegen<span class="text lstspace"> </span>bekannte<span class="text lstspace"> </span>Antworten<span class="text lstspace"> </span>pruefen</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">10</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span><span class="text lstkeywords" style="color:#FF0000;">case</span><span class="text lstspace"> </span>0:<span class="text lstspace">                     </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">0<span class="text lstspace"> </span>-<span class="text lstspace"> </span>Stepper<span class="text lstspace"> </span>Karte<span class="text lstspace"> </span>hat<span class="text lstspace"> </span>Befehl<span class="text lstspace"> </span>erkannt</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">11</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span>lcd_puts(”<span class="text" style="color:#000000;">Erfolgreich\n</span>”);</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">12</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span><span class="text lstkeywords" style="color:#FF0000;">break</span>;</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">13</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span><span class="text lstkeywords" style="color:#FF0000;">case</span><span class="text lstspace"> </span>1:<span class="text lstspace">                     </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">1<span class="text lstspace"> </span>-<span class="text lstspace"> </span>Stepper<span class="text lstspace"> </span>Karte<span class="text lstspace"> </span>meldet<span class="text lstspace"> </span>Error</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">14</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span>lcd_puts(”<span class="text" style="color:#000000;">Error\n</span>”);</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">15</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span>uart_put_string(”<span class="text" style="color:#000000;">1\r\n</span>”,<span class="text lstspace"> </span>D_RapidForm);</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">16</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span><span class="text lstkeywords" style="color:#FF0000;">break</span>;</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">17</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span><span class="text lstkeywords" style="color:#FF0000;">case</span><span class="text lstspace"> </span>2:<span class="text lstspace">                     </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">2<span class="text lstspace"> </span>-<span class="text lstspace"> </span>Clear<span class="text lstspace"> </span>Screen<span class="text lstspace"> </span>(Debugging)</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">18</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span>lcd_clrscr();</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">19</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span><span class="text lstkeywords" style="color:#FF0000;">break</span>;</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">20</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span><span class="text lstkeywords" style="color:#FF0000;">case</span><span class="text lstspace"> </span>3:<span class="text lstspace">                     </span>//<span class="text lstspace" style="color:#008000;"> </span><span class="text" style="color:#008000;">3<span class="text lstspace"> </span>-<span class="text lstspace"> </span>Test<span class="text lstspace"> </span>(Debugging)</span></span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">21</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span>lcd_puts(”<span class="text" style="color:#000000;">Test<span class="text lstspace"> </span>bestanden\n</span>”);</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">22</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span><span class="text lstkeywords" style="color:#FF0000;">break</span>;</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">23</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span><span class="text lstkeywords" style="color:#FF0000;">default</span>:</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">24</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">                </span>ms_spin(10);</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">25</span></td>
    <td class="td"><span class="text lstline footnote"><span class="text lstspace">        </span>}</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">26</span></td>
    <td class="td"><span class="text lstline footnote">}</span></td>
</tr>
</table></figure></section></section>
        </div>
    <footer class="footer">June 25, 2012<a href="Ch5.S2.html" title="5.2 Befehlssätze ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref previous"><span class="text reftitle"><span class="tag">5.2 </span>Befehlssätze</span></a><a href="Ch5.S4.html" title="5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref next"><span class="text reftitle"><span class="tag">5.4 </span>Verbesserungen an der vorhandenen Hardware</span></a>
      </footer>
      </div>
    </body>
</html>
