<!DOCTYPE html><html>
  <head>
    <title>5.2 Befehlssätze ‣ Chapter 5 Zeitlicher Arbeitsablauf</title>
    <!--Generated by LaTeXML (version 0.7.9alpha) on 2012-06-25T23:30:52+02:00.
        See http://dlmf.nist.gov/LaTeXML/-->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="start" href="Praxisbericht.html" title="">
    <link rel="prev" href="Ch5.S1.html" title="5.1 Bereitstellen grundlegender Funktionalitäten ‣ Chapter 5 Zeitlicher Arbeitsablauf">
    <link rel="next" href="Ch5.S3.html" title="5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf">
    <link rel="stylesheet" type="text/css" href="core.css">
    <link rel="stylesheet" type="text/css" href="navbar-left.css">
  </head>
  <body>
    <nav class="navbar"><a href="Praxisbericht.html" title="" class="ref start">?</a>
    
  <ul class="toc">
  <li class="tocentry">
<a href="Praxisbericht.html" title="" class="ref toc">?</a>
  <ul class="toc">
  <li class="tocentry"><a href="Ch1.html" title="Chapter 1 Hinweise zum Dokument" class="ref toc"><span class="text reftitle"><span class="tag">1 </span>Hinweise zum Dokument</span></a></li>
  <li class="tocentry"><a href="Ch2.html" title="Chapter 2 Einleitung" class="ref toc"><span class="text reftitle"><span class="tag">2 </span>Einleitung</span></a></li>
  <li class="tocentry"><a href="Ch3.html" title="Chapter 3 Vorstellung der vorhandenen Hardware" class="ref toc"><span class="text reftitle"><span class="tag">3 </span>Vorstellung der vorhandenen Hardware</span></a></li>
  <li class="tocentry"><a href="Ch4.html" title="Chapter 4 Vorstellung der vorhandenen Software" class="ref toc"><span class="text reftitle"><span class="tag">4 </span>Vorstellung der vorhandenen Software</span></a></li>
  <li class="tocentry">
<a href="Ch5.html" title="Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5 </span>Zeitlicher Arbeitsablauf</span></a>
  <ul class="toc">
  <li class="tocentry"><a href="Ch5.S1.html" title="5.1 Bereitstellen grundlegender Funktionalitäten ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.1 </span>Bereitstellen grundlegender Funktionalitäten</span></a></li>
  <li class="tocentry self"><span class="ref toc here"><span class="text reftitle"><span class="tag">5.2 </span>Befehlssätze</span></span></li>
  <li class="tocentry"><a href="Ch5.S3.html" title="5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.3 </span>Kommunikation mit der vorhandenen Schrittmotorsteuerung</span></a></li>
  <li class="tocentry"><a href="Ch5.S4.html" title="5.4 Verbesserungen an der vorhandenen Hardware ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.4 </span>Verbesserungen an der vorhandenen Hardware</span></a></li>
  <li class="tocentry"><a href="Ch5.S5.html" title="5.5 Kommunikation mit RapidForm2004 ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.5 </span>Kommunikation mit RapidForm2004</span></a></li>
  <li class="tocentry"><a href="Ch5.S6.html" title="5.6 Auswerte-Funktionen ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.6 </span>Auswerte-Funktionen</span></a></li>
  <li class="tocentry"><a href="Ch5.S7.html" title="5.7 Platinenlayout und 19”-Einschub ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref toc"><span class="text reftitle"><span class="tag">5.7 </span>Platinenlayout und 19”-Einschub</span></a></li>
    </ul>
</li>
  <li class="tocentry"><a href="Ch6.html" title="Chapter 6 Probleme und Lösungen" class="ref toc"><span class="text reftitle"><span class="tag">6 </span>Probleme und Lösungen</span></a></li>
  <li class="tocentry"><a href="Ch7.html" title="Chapter 7 Fazit und weitere Möglichkeiten" class="ref toc"><span class="text reftitle"><span class="tag">7 </span>Fazit und weitere Möglichkeiten</span></a></li>
  <li class="tocentry"><a href="bib.html" title="Bibliography" class="ref toc"><span class="text reftitle">Bibliography</span></a></li>
  <li class="tocentry"><a href="idx.html" title="Index" class="ref toc"><span class="text reftitle">Index</span></a></li>
    </ul>
</li>
    </ul>
      </nav>
    <div class="main">
    <header class="header"><a href="Ch5.html" title="Chapter 5 Zeitlicher Arbeitsablauf" class="ref up"><span class="text reftitle"><span class="tag">5 </span>Zeitlicher Arbeitsablauf</span></a><a href="Ch5.S1.html" title="5.1 Bereitstellen grundlegender Funktionalitäten ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref previous"><span class="text reftitle"><span class="tag">5.1 </span>Bereitstellen grundlegender Funktionalitäten</span></a><a href="Ch5.S3.html" title="5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref next"><span class="text reftitle"><span class="tag">5.3 </span>Kommunikation mit der vorhandenen Schrittmotorsteuerung</span></a>
      </header>
    <div class="content">
<section class="section"><hgroup><h1 class="title">
<span class="tag">5.2 </span>Befehlssätze</h1></hgroup><div id="p1" class="para"><p class="p">Das zu erreichende Ziel bestand darin, dass RapidForm2004 mit dem Mikrocontroller und dieser mit der Schrittmotorkarte kommunizieren können sollte. Die Kommunikation läuft dabei über Befehle ab, die über die serielle Schnittstelle gesendet werden.
Jede Schrittmotorkarte verwendet eigenen Befehle. Alle Befehle für eine Schrittmotorkarte werden im Folgenden als Befehlssatz bezeichnet. Die Software RapidForm2004 kennt mehrere Befehlssätze um verschiedene Schrittmotorkarten anzusteuern. Der Befehlssatz der vorhandenen Schrittmotorkarten zum Ansteuern der Motoren des Drehtisches ist jedoch nicht in RapidForm2004 vorhanden.<br class="break">Nun soll der Mikrocontroller sowohl mit RapidForm2004 als auch mit der ersten der vorhandenen Schrittmotorkarten kommunizieren. Befehle an die zweite Schrittmotorkarte werden über die Erste gesendet. Um mit beiden Seiten kommunizieren zu können muss der Mikrocontroller den Befehlssatz der vorhanden Schrittmotorkarten und zumindest einen der Befehlssätze aus RapidForm2004 kennen. Außerdem muss er wissen welche Antwort RapidForm2004 auf einen gesendeten Befehl erwartet. <br class="break">In der ersten Phase wurde die Software <em class="emph">Free Serial Port Monitor</em> verwendet um die Kommunikation zwischen RapidForm2004 und dem Mikrocontroller abzuhören. Dies hatte jedoch den Nachteil, das RapidForm2004 erst dann den nächsten Befehl sendete, wenn der Erste mit der erwarteten Antwort quittiert wurde. Die Befehle die RapidForm erwartete, konnten zwar teilweise aus den Betriebsanleitungen der Schrittmotorsteuerungen entnommen werden, dieses Vorgehen war jedoch sehr mühsam. Eine besseres Vorgehen, war das sogenannte <span class="text" style="background-color:#D9D9FF;">Reverse-Engineering</span>. Dadurch konnten alle Befehe und die darauf erwarteten Antworten aus einer ausführbaren Datei von RapidForm2004 ausgelesen werden.<br class="break">Das Codelisting <a href="#LST5" title="5 ‣ 5.2 Befehlssätze ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref"><span class="text reftag">5</span></a> zeigt einen Auszug für den Befehlssatz eines Isel Schrittmotors. Im Anhang <span class="ref here">LABEL:sec:Protokolle_RF</span> befinden sich die Befehlssätze aller Schrittmotorkarten. Somit stehen die Befehlssätze aller Schrittmotorsteuerungen zur Verfügung. Diese wurden in einer Textdatei gespeichert und werden später im Programm verwendet. Dadurch sind alle Befehle und die Antworten die RapidForm2004 auf einen daraus ausgesendeten Befehl erwartet bekannt.
</p></div>
<figure id="LST5" class="listing language_C"><figcaption class="caption"><span class="tag">Listing 5: </span>Befehlssatz aus Rapidform: Isel</figcaption><table class="tabular">
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">1</span></td>
    <td class="td"><span class="text lstline footnote">model<span class="text lstspace">        </span>”<span class="text" style="color:#000000;">isel(RF-1)</span>”</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">2</span></td>
    <td class="td"><span class="text lstline footnote">port<span class="text lstspace">        </span>”<span class="text" style="color:#000000;">9600</span>”<span class="text lstspace">                  </span>”<span class="text" style="color:#000000;">n81h</span>”</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">3</span></td>
    <td class="td"><span class="text lstline footnote">init<span class="text lstspace">        </span>”<span class="text" style="color:#000000;">@01\r</span>”<span class="text lstspace">                 </span>”<span class="text" style="color:#000000;">0</span>”</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">4</span></td>
    <td class="td"><span class="text lstline footnote">finish<span class="text lstspace">        </span>”<span class="text" style="color:#000000;">@0M0\054+600\r</span>”<span class="text lstspace">        </span>”<span class="text" style="color:#000000;">0</span>”</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">5</span></td>
    <td class="td"><span class="text lstline footnote">arot<span class="text lstspace">        </span>”<span class="text" style="color:#000000;">@0M%d\054+600\r</span>”<span class="text lstspace">       </span>”<span class="text" style="color:#000000;">0</span>”</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">6</span></td>
    <td class="td"><span class="text lstline footnote">stop<span class="text lstspace">        </span>””<span class="text lstspace">                      </span>”<span class="text" style="color:#000000;">0</span>”</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">7</span></td>
    <td class="td"><span class="text lstline footnote">home<span class="text lstspace">        </span>”<span class="text" style="color:#000000;">@0M0\054+600\r</span>”<span class="text lstspace">        </span>”<span class="text" style="color:#000000;">0</span>”</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">8</span></td>
    <td class="td"><span class="text lstline footnote">step<span class="text lstspace">        </span>”<span class="text" style="color:#000000;">-0.0173076</span>”<span class="text lstspace"> </span>”<span class="text" style="color:#000000;">-8000000</span>”<span class="text lstspace"> </span>”<span class="text" style="color:#000000;">8000000</span>”</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">9</span></td>
    <td class="td"><span class="text lstline footnote">timeout<span class="text lstspace"> </span>”<span class="text" style="color:#000000;">60</span>”</span></td>
</tr>
<tr class="tr">
    <td class="td linenumber"><span class="text tiny">10</span></td>
    <td class="td"><span class="text lstline footnote">firsttimeout<span class="text lstspace"> </span>”<span class="text" style="color:#000000;">10</span>”</span></td>
</tr>
</table></figure></section>
        </div>
    <footer class="footer">June 25, 2012<a href="Ch5.S1.html" title="5.1 Bereitstellen grundlegender Funktionalitäten ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref previous"><span class="text reftitle"><span class="tag">5.1 </span>Bereitstellen grundlegender Funktionalitäten</span></a><a href="Ch5.S3.html" title="5.3 Kommunikation mit der vorhandenen Schrittmotorsteuerung ‣ Chapter 5 Zeitlicher Arbeitsablauf" class="ref next"><span class="text reftitle"><span class="tag">5.3 </span>Kommunikation mit der vorhandenen Schrittmotorsteuerung</span></a>
      </footer>
      </div>
    </body>
</html>
